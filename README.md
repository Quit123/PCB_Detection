# PCB Detection

## ç¯å¢ƒå®‰è£…è¦æ±‚

æœ¬é¡¹ç›®åŸºäº Python 3.10ï¼Œæ¨èä½¿ç”¨ Conda åˆ›å»ºéš”ç¦»è™šæ‹Ÿç¯å¢ƒã€‚

### 1ï¸âƒ£ åˆ›å»ºå¹¶æ¿€æ´» Conda è™šæ‹Ÿç¯å¢ƒ

```bash
conda create -n yolov11 python=3.10
conda activate yolov11
```

### 2ï¸âƒ£ å®‰è£… JupyterLabï¼ˆå¯é€‰ï¼Œç”¨äºäº¤äº’å¼å¼€å‘ï¼‰

```bash
conda install jupyterlab
```

### 3ï¸âƒ£ å®‰è£… PyTorch + CUDA 11.8

è¯·æ ¹æ®ä½ çš„æ˜¾å¡é©±åŠ¨é€‰æ‹©åˆé€‚çš„ CUDA ç‰ˆæœ¬ï¼Œä»¥ä¸‹ä¸º CUDA 11.8 ç¤ºä¾‹ï¼š

```bash
pip install torch==2.0.0+cu118 torchvision==0.15.1+cu118 --extra-index-url https://download.pytorch.org/whl/cu118
```

### 4ï¸âƒ£ å®‰è£…é¡¹ç›®ä¾èµ–

```bash
pip install requirements.txt
```
è‹¥ç¼ºåŒ…è¯·æŒ‰ç…§æŠ¥é”™è¯´æ˜pip install <package_name>

---

## æ•°æ®é›†ç›®å½•ç»“æ„

æœ¬é¡¹ç›®æ•°æ®é›†ç»„ç»‡ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œé€‚ç”¨äº BJ-PCB ç¼ºé™·æ£€æµ‹ä»»åŠ¡ï¼š

```plaintext
./
â”œâ”€â”€ backend_detect/                  # åç«¯ï¼šæ£€æµ‹æœåŠ¡æ¨¡å—ï¼ˆå¦‚ä¸»åŠ¨å­¦ä¹ ã€é¢„æµ‹æœåŠ¡ï¼‰
â”‚   â”œâ”€â”€ active_learning/            # ä¸»åŠ¨å­¦ä¹ æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ datasets/simulate_ready_push/  # æ¨¡æ‹Ÿæ•°æ®é›†å­˜æ”¾è·¯å¾„
â”‚   â”œâ”€â”€ runs/active_learning/       # ä¸»åŠ¨å­¦ä¹ è¿‡ç¨‹ä¸­çš„è¿è¡Œæ—¥å¿—å’Œæ¨¡å‹ä¿å­˜
â”‚   â”œâ”€â”€ server.py                   # æ£€æµ‹æœåŠ¡å…¥å£
â”‚   â””â”€â”€ pre.py                      # æ•°æ®é¢„å¤„ç†è„šæœ¬

â”œâ”€â”€ backend_model/                  # åç«¯ï¼šæ¨¡å‹è®­ç»ƒæ¨¡å—ï¼ˆåŸºäºYOLO/Ultralyticsï¼‰
â”‚   â”œâ”€â”€ active_learning/            # ä¸detectå…±ç”¨çš„ä¸»åŠ¨å­¦ä¹ æ¨¡å—
â”‚   â”œâ”€â”€ docker/                     # Dockeréƒ¨ç½²ç›¸å…³
â”‚   â”œâ”€â”€ docs/                       # é¡¹ç›®æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ examples/                   # ç¤ºä¾‹è„šæœ¬ä¸é…ç½®
â”‚   â”œâ”€â”€ runs/active_learning/       # è®­ç»ƒ/æ¨ç†è¾“å‡ºç»“æœ
â”‚   â”œâ”€â”€ tests/                      # å•å…ƒæµ‹è¯•æ¨¡å—
â”‚   â”œâ”€â”€ ultralytics/                # YOLOæ¨¡å‹æºç åŠå®šåˆ¶æ¨¡å—
â”‚   â”œâ”€â”€ *.yaml                      # æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼ˆBJ-PCBã€GSD-PCBç­‰ï¼‰
â”‚   â”œâ”€â”€ detect.py                   # æ¨ç†è„šæœ¬
â”‚   â”œâ”€â”€ train.py / val.py / test.py # è®­ç»ƒã€éªŒè¯ã€æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ server.py                   # è®­ç»ƒæœåŠ¡å…¥å£
â”‚   â””â”€â”€ image_labeler.py           # å›¾åƒæ ‡æ³¨é€»è¾‘ï¼ˆæ¨æµ‹ç”¨äºäº¤äº’å¼æ ‡æ³¨ï¼‰

â”œâ”€â”€ frontend/                       # å‰ç«¯ï¼šåŸºäº Vue + TypeScript çš„å¯è§†åŒ–ç•Œé¢
â”‚   â”œâ”€â”€ public/                     # é™æ€èµ„æºç›®å½•
â”‚   â”œâ”€â”€ src/                        # å‰ç«¯æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ assets/                # å›¾åƒèµ„æºç­‰
â”‚   â”‚   â”œâ”€â”€ components/           # æ ¸å¿ƒç»„ä»¶åŒºå—ï¼ˆå¦‚æ ‡æ³¨åŒºåŸŸã€ç»“æœå±•ç¤ºï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ ControlPanel.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ DetectionArea.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ LabelArea.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ ResultTable.vue
â”‚   â”‚   â”‚   â””â”€â”€ TransfImg.vue
â”‚   â”‚   â”œâ”€â”€ stores/               # çŠ¶æ€ç®¡ç†æ¨¡å—ï¼ˆPiniaï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ manageImg.ts
â”‚   â”‚   â”‚   â””â”€â”€ manageModel.ts
â”‚   â”‚   â””â”€â”€ main.ts / App.vue     # é¡¹ç›®å…¥å£
â”‚   â”œâ”€â”€ package.json               # å‰ç«¯ä¾èµ–ç®¡ç†
â”‚   â””â”€â”€ vite.config.ts             # æ„å»ºé…ç½®æ–‡ä»¶ï¼ˆViteï¼‰

â”œâ”€â”€ requirements.txt               # Pythonä¾èµ–åˆ—è¡¨ï¼ˆåç«¯ç¯å¢ƒï¼‰
â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

### è¯´æ˜

* `Dataset_Name/images/` å’Œ `Dataset_Name/labels/` ç”¨äºè®­ç»ƒã€éªŒè¯ã€æµ‹è¯•ã€‚
* `raw/Dataset_Name/Annotations/` ä¸ºæ¯ç±»ç¼ºé™·çš„åŸå§‹æ ‡æ³¨æ–‡ä»¶ï¼ˆå¦‚ XMLï¼‰ã€‚
* `raw/Dataset_Name/labels/` æ˜¯è½¬æ¢åçš„ YOLO æ ¼å¼æ ‡æ³¨æ–‡ä»¶ï¼Œç”¨äºè®­ç»ƒã€‚
* å»ºè®®åœ¨æ•°æ®é¢„å¤„ç†é˜¶æ®µï¼Œå°†åŸå§‹æ•°æ®ç»„ç»‡æˆ YOLO æ‰€éœ€çš„ `images/` å’Œ `labels/` ç»“æ„ã€‚

### ç¤ºä¾‹æ ‡æ³¨æ–‡ä»¶

YOLO æ ¼å¼æ ‡ç­¾ï¼ˆ`.txt` æ–‡ä»¶ï¼‰ï¼š

```
<class_id> <x_center> <y_center> <width> <height>
```

æ•°å€¼å‡å½’ä¸€åŒ–åˆ° 0\~1ã€‚

å¦‚éœ€æ•°æ®é›†åˆ’åˆ†å’Œæ ¼å¼è½¬æ¢è„šæœ¬ï¼Œå¯å‚è€ƒæœ¬é¡¹ç›®æä¾›çš„ `pre.py` æˆ–è‡ªè¡Œç¼–å†™æ‰¹å¤„ç†è„šæœ¬ã€‚

---

### ğŸ§­ ä½¿ç”¨è¯´æ˜

æœ¬é¡¹ç›®ç”±ä¸¤ä¸ªåç«¯æ¨¡å—ä¸ä¸€ä¸ªå‰ç«¯å¯è§†åŒ–ç•Œé¢ç»„æˆã€‚è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤è¿è¡Œé¡¹ç›®ï¼š

#### âœ… å®‰è£…ä¾èµ–

```bash
# å®‰è£…åç«¯ä¾èµ–
pip install -r requirements.txt

# å®‰è£…å‰ç«¯ä¾èµ–
cd frontend
npm install
```

#### ğŸš€ å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨åç«¯æœåŠ¡ 1ï¼šæ£€æµ‹æœåŠ¡
cd backend_detect
python server.py

# å¯åŠ¨åç«¯æœåŠ¡ 2ï¼šæ¨¡å‹æœåŠ¡
cd backend_model
python server.py

# å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆåŸºäº Vue + Viteï¼‰
cd frontend
npm run dev
```

#### âš™ï¸ é…ç½®æœåŠ¡åœ°å€ï¼ˆå¯é€‰ï¼‰

å„æ¨¡å—é—´çš„æœåŠ¡é€šä¿¡åœ°å€é€šè¿‡ `.env` æ–‡ä»¶è¿›è¡Œé…ç½®ï¼š

| è·¯å¾„                    | åŠŸèƒ½è¯´æ˜                                        |
| --------------------- | ------------------------------------------- |
| `backend_detect/.env` | è®¾ç½®å‰ç«¯è®¿é—® backend\_detect çš„ IP å’Œç«¯å£             |
| `backend_model/.env`  | è®¾ç½® backend\_model è®¿é—® backend\_detect çš„åœ°å€    |
| `frontend/.env`       | è®¾ç½®å‰ç«¯è®¿é—® backend\_detect å’Œ backend\_model çš„åœ°å€ |

ç¤ºä¾‹ `frontend/.env` é…ç½®ï¼š

```env
VITE_DETECT_API_URL=http://localhost:8000
VITE_MODEL_API_URL=http://localhost:8001
```

è¯·æ ¹æ®å®é™…è¿è¡Œç¯å¢ƒè°ƒæ•´ IP å’Œç«¯å£ï¼Œç¡®ä¿æœåŠ¡æ­£å¸¸äº’é€šã€‚

---

## æ³¨æ„äº‹é¡¹

* å¦‚æœä½ çš„æ˜¾å¡é©±åŠ¨ç‰ˆæœ¬ä¸æ”¯æŒ CUDA 11.8ï¼Œè¯·è®¿é—® [PyTorch å®˜ç½‘](https://pytorch.org/get-started/locally/) é€‰æ‹©åˆé€‚ç‰ˆæœ¬ã€‚
* æœ¬é¡¹ç›®æ”¯æŒ Windowsã€Linux ç³»ç»Ÿï¼Œæ¨èä½¿ç”¨ Conda ç®¡ç† Python ç¯å¢ƒã€‚
* å®‰è£…è¿‡ç¨‹ä¸­å¦‚é‡ä¾èµ–å†²çªæˆ–å®‰è£…å¤±è´¥ï¼Œå»ºè®®å…ˆæ›´æ–° Condaï¼š

```bash
conda update -n base -c defaults conda
```
